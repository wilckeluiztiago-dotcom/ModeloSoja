import pandas as pd
import numpy as np

class DadosConabReal:
    """
    Carrega dados reais históricos da CONAB (Companhia Nacional de Abastecimento).
    Agora com dados segregados de Área (Mil ha) e Produtividade (kg/ha).
    Dados aproximados da série histórica real (2007-2024).
    Autor: Luiz Tiago Wilcke
    """
    
    ANOS = list(range(2007, 2025))
    
    # Área Plantada (Mil hectares)
    AREA_REAL = {
        'MT': [5800, 6000, 6200, 6400, 7000, 7800, 8400, 8900, 9200, 9400, 9600, 9900, 10200, 10700, 11200, 11800, 12100, 12400],
        'PR': [4000, 4200, 4400, 4500, 4600, 4800, 4900, 5100, 5200, 5300, 5400, 5450, 5500, 5600, 5650, 5700, 5750, 5800],
        'RS': [3800, 3900, 4000, 4100, 4300, 4500, 4800, 5100, 5300, 5500, 5700, 5900, 6000, 6200, 6300, 6400, 6500, 6600],
        'GO': [2200, 2300, 2500, 2600, 2700, 2800, 2900, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 4000, 4200, 4400],
        'MS': [1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2800, 3000, 3200, 3400, 3600, 3800, 4000],
        'BA': [900, 1000, 1100, 1200, 1250, 1300, 1400, 1500, 1550, 1580, 1600, 1600, 1650, 1700, 1750, 1800, 1850, 1900],
        'MG': [950, 1000, 1050, 1100, 1200, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1700, 1800, 1900, 2000, 2100, 2200],
        'TO': [300, 350, 400, 450, 500, 600, 700, 800, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350],
        'SC': [400, 420, 440, 460, 480, 500, 550, 600, 620, 640, 660, 680, 700, 710, 720, 730, 740, 750],
        'MA': [350, 400, 450, 500, 550, 600, 650, 700, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250],
        'PI': [200, 250, 300, 350, 400, 450, 500, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100],
        'SP': [600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450]
    }

    # Produtividade Real (kg/ha)
    PRODUTIVIDADE_REAL = {
        'MT': [3000, 3050, 3100, 3150, 3200, 3100, 3250, 3300, 3200, 3350, 3400, 3450, 3500, 3550, 3500, 3600, 3550, 3400],
        'PR': [2900, 3000, 2100, 3200, 3300, 2200, 3400, 3000, 3500, 3600, 3700, 3800, 3200, 3900, 3800, 2000, 3900, 3500],
        'RS': [2400, 1800, 2500, 2800, 1500, 2900, 3000, 3100, 3200, 3300, 3400, 3100, 1600, 3500, 3300, 1200, 2100, 3200],
        'GO': [2800, 2900, 3000, 3100, 3200, 3150, 3300, 3250, 3350, 3400, 3500, 3550, 3600, 3650, 3700, 3750, 3800, 3700],
        'MS': [2700, 2800, 2900, 3000, 3100, 3000, 3200, 3150, 3300, 3350, 3400, 3500, 3200, 3600, 3500, 2000, 3700, 3400],
        'BA': [2800, 2900, 3000, 3100, 2500, 2600, 2800, 2400, 3200, 2300, 3300, 3400, 3500, 3600, 3700, 3800, 3750, 3600],
        'MG': [2600, 2700, 2800, 2900, 3000, 2900, 3100, 3050, 3200, 3250, 3300, 3400, 3500, 3600, 3550, 3650, 3600, 3500],
        'TO': [2500, 2600, 2700, 2800, 2900, 2800, 3000, 2900, 3100, 3150, 3200, 3250, 3300, 3350, 3400, 3450, 3400, 3300],
        'SC': [2800, 2900, 3000, 3100, 3200, 2800, 3300, 3200, 3400, 3500, 3600, 3700, 3200, 3800, 3700, 3000, 3800, 3750],
        'MA': [2400, 2500, 2600, 2700, 2800, 2500, 2900, 2800, 3000, 3100, 3200, 3250, 3300, 3350, 3400, 3450, 3400, 3350],
        'PI': [2300, 2400, 2500, 2600, 2700, 2400, 2800, 2700, 2900, 3000, 3100, 3150, 3200, 3250, 3300, 3350, 3300, 3200],
        'SP': [2700, 2800, 2900, 3000, 3100, 3000, 3200, 3150, 3300, 3350, 3400, 3450, 3500, 3550, 3600, 3650, 3600, 3500]
    }

    def obter_dados_completos(self, uf):
        """Retorna DataFrame com Área, Produtividade e Produção (Calculada)."""
        if uf not in self.AREA_REAL:
             raise ValueError(f"Estado {uf} não disponível na base CONAB.")
             
        area = np.array(self.AREA_REAL[uf])
        yield_ = np.array(self.PRODUTIVIDADE_REAL[uf])
        producao = area * yield_ / 1000 # Converter para Mil Toneladas
        
        df = pd.DataFrame({
            'Ano': self.ANOS,
            'Area_Mil_Ha': area,
            'Produtividade_Kg_Ha': yield_,
            'Producao_Mil_Ton': producao,
            'Estado': uf
        })
        return df.set_index('Ano')
